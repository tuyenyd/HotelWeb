<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Đánh giá & Phản hồi - HotelAdmin</title>
    <link href="assets/img/img.png" rel="icon">
    <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">
    <!-- CSS Files -->
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="assets/css/style.css" rel="stylesheet">
    <style>
        .rating-stars {
            color: #ffc107;
        }
        .customer-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            color: #fff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        .bg-success { background: #198754 !important; }
        .bg-danger { background: #dc3545 !important; }
        .bg-warning { background: #ffc107 !important; color: #212529 !important; }
        .bg-info { background: #0dcaf0 !important; }
        .bg-orange { background: #fd7e14 !important; }
        .feedback-card {
            border-left: 4px solid #4154f1;
            transition: all 0.3s ease;
            min-height: 320px;
        }
        .feedback-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .feedback-card.negative {
            border-left-color: #dc3545;
        }
        .feedback-card.positive {
            border-left-color: #198754;
        }
        .feedback-card.neutral {
            border-left-color: #ffc107;
        }
        .sentiment-badge {
            font-size: 0.75rem;
            padding: 0.35em 0.65em;
        }
        .response-box {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            border-left: 4px solid #4154f1;
        }
        .feedback-actions button {
            margin-right: 0.5rem;
        }
        @media (max-width: 768px) {
            .feedback-card { min-height: 0; }
            .customer-avatar { width: 36px; height: 36px; font-size: 1rem; }
        }
        .loading-spinner {
            display: none;
            margin-right: 8px;
            vertical-align: middle;
        }
        .modal-success {
            display: none;
            color: #198754;
            font-weight: bold;
            margin-bottom: 1rem;
        }
    </style>
    <script>
        // Mẫu phản hồi nhanh (demo)
        let responseTemplates = [
            "Cảm ơn bạn đã phản hồi. Chúng tôi sẽ khắc phục ngay.",
            "Cảm ơn bạn đã dành lời khen. Hy vọng được đón tiếp bạn lần sau.",
            "Chúng tôi xin lỗi vì sự bất tiện này. Sẽ cải thiện ngay."
        ];

        // Chèn mẫu phản hồi vào textarea
        function insertTemplate(val) {
            if (!val) return;
            const textarea = document.querySelector('#replyModal textarea[placeholder]');
            textarea.value = val;
        }

        // Hiệu ứng gửi phản hồi, xác thực, thông báo thành công, tự động đóng modal
        function sendReply(btn) {
            const textarea = document.querySelector('#replyModal textarea[placeholder]');
            if (!textarea.value.trim()) {
                textarea.classList.add('is-invalid');
                textarea.focus();
                return;
            }
            textarea.classList.remove('is-invalid');
            btn.disabled = true;
            document.getElementById('replySpinner').style.display = 'inline-block';
            setTimeout(function() {
                document.getElementById('replySpinner').style.display = 'none';
                document.getElementById('replySuccess').style.display = 'block';
                btn.disabled = false;
                setTimeout(function() {
                    document.getElementById('replySuccess').style.display = 'none';
                    var modal = bootstrap.Modal.getInstance(document.getElementById('replyModal'));
                    modal.hide();
                }, 1200);
            }, 1200);
        }

        // Mở modal phản hồi với thông tin động
        function openReplyModal(customer, feedback) {
            const modal = new bootstrap.Modal(document.getElementById('replyModal'));
            document.querySelector('#replyModal input[type="text"]').value = customer;
            document.querySelector('#replyModal textarea[readonly]').value = feedback;
            document.querySelector('#replyModal textarea[placeholder]').value = '';
            document.getElementById('replySuccess').style.display = 'none';
            document.getElementById('replySpinner').style.display = 'none';
            modal.show();
        }

        // Sửa phản hồi: mở modal với nội dung cũ
        function editReply(customer, feedback, reply) {
            const modal = new bootstrap.Modal(document.getElementById('replyModal'));
            document.querySelector('#replyModal input[type="text"]').value = customer;
            document.querySelector('#replyModal textarea[readonly]').value = feedback;
            document.querySelector('#replyModal textarea[placeholder]').value = reply;
            document.getElementById('replySuccess').style.display = 'none';
            document.getElementById('replySpinner').style.display = 'none';
            modal.show();
        }

        // Đánh dấu đã xử lý: cập nhật trạng thái trên giao diện
        function markHandled(btn) {
            btn.disabled = true;
            btn.innerHTML = '<i class="bi bi-check-circle"></i> Đã xử lý';
            btn.classList.remove('btn-outline-success');
            btn.classList.add('btn-success');
            btn.title = 'Đã xử lý';
            const card = btn.closest('.feedback-card');
            let badge = card.querySelector('.sentiment-badge');
            if (badge) {
                badge.textContent = 'Đã xử lý';
                badge.classList.remove('bg-success', 'bg-warning', 'bg-danger');
                badge.classList.add('bg-info');
            }
            card.querySelectorAll('.feedback-actions button').forEach(function(b){
                if(b!==btn) b.disabled = true;
            });
        }

        // Đánh giá hữu ích: tăng số lượt hữu ích (demo)
        function markUseful(btn) {
            let count = btn.dataset.count ? parseInt(btn.dataset.count) : 0;
            count++;
            btn.dataset.count = count;
            btn.innerHTML = `<i class="bi bi-hand-thumbs-up"></i> Hữu ích (${count})`;
        }

        // Liên hệ trực tiếp: hiển thị thông báo
        function contactCustomer(btn) {
            alert('Đã gửi yêu cầu liên hệ trực tiếp tới khách hàng.');
        }

        // Báo cáo đánh giá xấu: hiển thị thông báo
        function reportFeedback(btn) {
            alert('Đã báo cáo đánh giá này tới quản trị viên.');
        }

        function markNeutralHandled(btn) {
            markHandled(btn);
        }

        // Tooltip cho các nút
        document.addEventListener('DOMContentLoaded', function() {
            var tooltipTriggerList = [].slice.call(document.querySelectorAll('[title]'));
            tooltipTriggerList.forEach(function (el) {
                new bootstrap.Tooltip(el);
            });

            // Reset modal khi mở lại
            var replyModal = document.getElementById('replyModal');
            replyModal.addEventListener('show.bs.modal', function () {
                document.getElementById('replySuccess').style.display = 'none';
                document.getElementById('replySpinner').style.display = 'none';
                replyModal.querySelector('textarea[placeholder]').value = '';
                replyModal.querySelector('select').selectedIndex = 0;
                replyModal.querySelector('textarea[placeholder]').classList.remove('is-invalid');
                // Cập nhật mẫu phản hồi nhanh
                const select = replyModal.querySelector('select');
                select.innerHTML = '<option value="">Chọn mẫu phản hồi</option>' +
                    responseTemplates.map(t => `<option value="${t}">${t}</option>`).join('');
            });

            // Quản lý mẫu phản hồi nhanh
            var templateModal = document.getElementById('responseTemplateModal');
            templateModal.addEventListener('show.bs.modal', function () {
                let body = templateModal.querySelector('.modal-body');
                let html = '<ul class="list-group mb-3">';
                responseTemplates.forEach((t, i) => {
                    html += `<li class="list-group-item d-flex justify-content-between align-items-center">
                        <span>${t}</span>
                        <button class="btn btn-sm btn-danger" onclick="removeTemplate(${i})"><i class="bi bi-trash"></i></button>
                    </li>`;
                });
                html += '</ul>';
                html += `<div class="input-group">
                    <input type="text" class="form-control" id="newTemplateInput" placeholder="Thêm mẫu mới...">
                    <button class="btn btn-primary" onclick="addTemplate()">Thêm</button>
                </div>`;
                body.innerHTML = html;
            });
        });

        // Thêm/xóa mẫu phản hồi nhanh
        function addTemplate() {
            const input = document.getElementById('newTemplateInput');
            const val = input.value.trim();
            if (val && !responseTemplates.includes(val)) {
                responseTemplates.push(val);
                input.value = '';
                bootstrap.Modal.getInstance(document.getElementById('responseTemplateModal')).hide();
                setTimeout(() => {
                    bootstrap.Modal.getOrCreateInstance(document.getElementById('responseTemplateModal')).show();
                }, 300);
            }
        }
        function removeTemplate(idx) {
            responseTemplates.splice(idx, 1);
            bootstrap.Modal.getInstance(document.getElementById('responseTemplateModal')).hide();
            setTimeout(() => {
                bootstrap.Modal.getOrCreateInstance(document.getElementById('responseTemplateModal')).show();
            }, 300);
        }

        // Lọc đánh giá (demo, chỉ lọc trên giao diện)
        function filterFeedbacks() {
            const star = document.getElementById('filter-star').value;
            const status = document.getElementById('filter-status').value;
            const source = document.getElementById('filter-source').value;
            document.querySelectorAll('.feedback-card').forEach(card => {
                let show = true;
                if (star !== 'Tất cả đánh giá') {
                    if (star === '5 sao' && !card.classList.contains('positive')) show = false;
                    if (star === '4 sao' && !card.classList.contains('neutral')) show = false;
                    if (star === '3 sao' && !card.classList.contains('neutral')) show = false;
                    if (star === '2 sao' && !card.classList.contains('negative')) show = false;
                    if (star === '1 sao' && !card.classList.contains('negative')) show = false;
                }
                if (status !== 'Tất cả trạng thái') {
                    let badge = card.querySelector('.sentiment-badge');
                    if (status === 'Chưa trả lời' && badge && badge.textContent !== 'Tiêu cực' && badge.textContent !== 'Trung bình') show = false;
                    if (status === 'Đã trả lời' && badge && badge.textContent !== 'Đã trả lời') show = false;
                    if (status === 'Đã xử lý' && badge && badge.textContent !== 'Đã xử lý') show = false;
                }
                // Nguồn: demo, không có dữ liệu nguồn thực tế
                card.style.display = show ? '' : 'none';
            });
        }

        // Xóa đánh giá sau khi đã xử lý
        function deleteFeedback(btn) {
            if (confirm('Bạn có chắc chắn muốn xóa đánh giá này?')) {
                const card = btn.closest('.feedback-card');
                card.style.display = 'none';
            }
        }
    </script>
</head>
<body>

<!-- Header và Sidebar giống trang trước -->
<header id="header" class="header fixed-top d-flex align-items-center">

    <div class="d-flex align-items-center justify-content-between">
        <a href="index.html" class="logo d-flex align-items-center">
            <img src="assets/img/logo.png" alt="Logo">
            <span class="d-none d-lg-block">Hotel</span>
        </a>
        <i class="bi bi-list toggle-sidebar-btn"></i>
    </div><div class="search-bar">
    <form class="search-form d-flex align-items-center" method="POST" action="#">
        <input type="text" name="query" placeholder="Tìm kiếm đặt phòng, khách hàng..." title="Nhập từ khóa tìm kiếm">
        <button type="submit" title="Tìm kiếm"><i class="bi bi-search"></i></button>
    </form>
</div><nav class="header-nav ms-auto">
    <ul class="d-flex align-items-center">

        <li class="nav-item d-block d-lg-none">
            <a class="nav-link nav-icon search-bar-toggle " href="#">
                <i class="bi bi-search"></i>
            </a>
        </li><li class="nav-item dropdown">
        <a class="nav-link nav-icon" href="#" data-bs-toggle="dropdown">
            <i class="bi bi-bell"></i>
            <span class="badge bg-primary badge-number">3</span>
        </a><ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow notifications">
        <li class="dropdown-header">
            Bạn có 3 thông báo mới
            <a href="#"><span class="badge rounded-pill bg-primary p-2 ms-2">Xem tất cả</span></a>
        </li>
        <li>
            <hr class="dropdown-divider">
        </li>

        <li class="notification-item">
            <i class="bi bi-exclamation-circle text-warning"></i>
            <div>
                <h4>Đặt phòng mới</h4>
                <p>Khách hàng Nguyễn Văn A vừa đặt phòng Deluxe</p>
                <p>5 phút trước</p>
            </div>
        </li>

        <li>
            <hr class="dropdown-divider">
        </li>

        <li class="notification-item">
            <i class="bi bi-x-circle text-danger"></i>
            <div>
                <h4>Hủy đặt phòng</h4>
                <p>Đặt phòng #2457 đã bị hủy</p>
                <p>2 giờ trước</p>
            </div>
        </li>

        <li>
            <hr class="dropdown-divider">
        </li>

        <li class="notification-item">
            <i class="bi bi-check-circle text-success"></i>
            <div>
                <h4>Phản hồi mới</h4>
                <p>Bạn có 2 đánh giá mới từ khách hàng</p>
                <p>4 giờ trước</p>
            </div>
        </li>

        <li>
            <hr class="dropdown-divider">
        </li>
        <li class="dropdown-footer">
            <a href="#">Hiển thị tất cả thông báo</a>
        </li>
    </ul></li><li class="nav-item dropdown pe-3">

        <a class="nav-link nav-profile d-flex align-items-center pe-0" href="#" data-bs-toggle="dropdown">
            <img src="assets/img/profile-img.jpg" alt="Hồ sơ" class="rounded-circle">
            <span class="d-none d-md-block dropdown-toggle ps-2" id="profileName">Đang tải...</span>
        </a>
        <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow profile">
            <li class="dropdown-header">
                <h6 id="profileDropdownName">...</h6>
                <span id="profileDropdownRole">...</span>
            </li>
            <li>
                <hr class="dropdown-divider">
            </li>

            <li>
                <a class="dropdown-item d-flex align-items-center" href="users-profile.html">
                    <i class="bi bi-person"></i>
                    <span>Hồ sơ của tôi</span>
                </a>
            </li>
            <li>
                <hr class="dropdown-divider">
            </li>

            <li>
                <a class="dropdown-item d-flex align-items-center" href="users-profile.html">
                    <i class="bi bi-gear"></i>
                    <span>Cài đặt tài khoản</span>
                </a>
            </li>
            <li>
                <hr class="dropdown-divider">
            </li>

            <li>
                <a class="dropdown-item d-flex align-items-center" href="#" id="logoutButton">
                    <i class="bi bi-box-arrow-right"></i>
                    <span>Đăng xuất</span>
                </a>
            </li>
        </ul></li></ul>
</nav>
</header><!-- Kết thúc Header -->

<!-- ======= Sidebar ======= -->
<aside id="sidebar" class="sidebar">

    <ul class="sidebar-nav" id="sidebar-nav">

        <li class="nav-item">
            <a class="nav-link collapsed" href="index.html">
                <i class="bi bi-house-door"></i>
                <span>Bảng Điều Khiển</span>
            </a>
        </li><!-- Kết thúc Điều hướng Bảng Điều Khiển -->

        <li class="nav-item">
            <a class="nav-link collapsed" data-bs-target="#booking-nav" data-bs-toggle="collapse" href="#">
                <i class="bi bi-calendar-check"></i><span>Quản lý Đặt phòng</span><i class="bi bi-chevron-down ms-auto"></i>
            </a>
            <ul id="booking-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
                <li>
                    <a href="tatcadatphong.html">
                        <i class="bi bi-circle"></i><span>Tất cả đặt phòng</span>
                    </a>
                </li>
                <li>
                    <a href="checkin.html">
                        <i class="bi bi-circle"></i><span>Check-in</span>
                    </a>
                </li>
                <li>
                    <a href="checkout.html">
                        <i class="bi bi-circle"></i><span>Check-out</span>
                    </a>
                </li>
            </ul>
        </li><!-- Kết thúc Điều hướng Đặt phòng -->

        <li class="nav-item">
            <a class="nav-link collapsed" data-bs-target="#room-nav" data-bs-toggle="collapse" href="#">
                <i class="bi bi-door-closed"></i><span>Quản lý Phòng</span><i class="bi bi-chevron-down ms-auto"></i>
            </a>
            <ul id="room-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
                <li>
                    <a href="danhsachphong.html">
                        <i class="bi bi-circle"></i><span>Danh sách phòng</span>
                    </a>
                </li>
                <li>
                    <a href="loaiphong.html">
                        <i class="bi bi-circle"></i><span>Loại phòng</span>
                    </a>
                </li>
                <li>
                    <a href="tinhtrangphong.html">
                        <i class="bi bi-circle"></i><span>Tình trạng phòng</span>
                    </a>
                </li>
                <li>
                    <a href="giaphong.html">
                        <i class="bi bi-circle"></i><span>Giá phòng</span>
                    </a>
                </li>
            </ul>
        </li><!-- Kết thúc Điều hướng Phòng -->

        <li class="nav-item">
            <a class="nav-link " data-bs-target="#customer-nav" data-bs-toggle="collapse" href="#">
                <i class="bi bi-people"></i><span>Quản lý Khách hàng</span><i class="bi bi-chevron-down ms-auto"></i>
            </a>
            <ul id="customer-nav" class="nav-content collapse show" data-bs-parent="#sidebar-nav">
                <li>
                    <a href="danhsachkhachhang.html">
                        <i class="bi bi-circle"></i><span>Danh sách khách hàng</span>
                    </a>
                </li>
                <li>
                    <a href="chuongtrinhthanhvien.html">
                        <i class="bi bi-circle"></i><span>Chương trình thành viên</span>
                    </a>
                </li>
                <li>
                    <a href="danhgia&phanhoi.html" class="active">
                        <i class="bi bi-circle"></i><span>Đánh giá & Phản hồi</span>
                    </a>
                </li>
            </ul>
        </li><!-- Kết thúc Điều hướng Khách hàng -->

        <li class="nav-item">
            <a class="nav-link collapsed" href="baocao&thongke.html">
                <i class="bi bi-bar-chart"></i>
                <span>Báo cáo & Thống kê</span>
            </a>
        </li><!-- Kết thúc Điều hướng Báo cáo -->

        <li class="nav-item">
            <a class="nav-link collapsed" data-bs-target="#finance-nav" data-bs-toggle="collapse" href="#">
                <i class="bi bi-cash-coin"></i><span>Tài chính</span><i class="bi bi-chevron-down ms-auto"></i>
            </a>
            <ul id="finance-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
                <li>
                    <a href="finance-invoices.html">
                        <i class="bi bi-circle"></i><span>Hóa đơn</span>
                    </a>
                </li>
                <li>
                    <a href="finance-payments.html">
                        <i class="bi bi-circle"></i><span>Thanh toán</span>
                    </a>
                </li>
                <li>
                    <a href="finance-revenue.html">
                        <i class="bi bi-circle"></i><span>Doanh thu</span>
                    </a>
                </li>
            </ul>
        </li><!-- Kết thúc Điều hướng Tài chính -->

        <li class="nav-heading">Trang</li>

        <li class="nav-item">
            <a class="nav-link collapsed" href="users-profile.html">
                <i class="bi bi-person"></i>
                <span>Hồ sơ</span>
            </a>
        </li><!-- Kết thúc Trang Hồ sơ -->

        <li class="nav-item">
            <a class="nav-link collapsed" href="pages-contact.html">
                <i class="bi bi-envelope"></i>
                <span>Liên hệ</span>
            </a>
        </li><!-- Kết thúc Trang Liên hệ -->
        <li class="nav-item">
            <a class="nav-link collapsed" href="users.html">
                <i class="bi bi-person-gear"></i>
                <span>Nhân viên</span>
            </a>
        </li>

        <li class="nav-item">
            <a class="nav-link collapsed" href="taikhoan.html">
                <i class="bi bi-person-badge"></i>
                <span>Tài khoản</span>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link collapsed" href="settings.html">
                <i class="bi bi-gear"></i>
                <span>Cài đặt</span>
            </a>
        </li>

    </ul>

</aside><!-- Kết thúc Sidebar -->
<main id="main" class="main">
    <div class="pagetitle d-flex justify-content-between align-items-center">
        <h1>Đánh giá & Phản hồi</h1>
        <nav>
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="index.html">Trang chủ</a></li>
                <li class="breadcrumb-item">Quản lý Khách hàng</li>
                <li class="breadcrumb-item active">Đánh giá & Phản hồi</li>
            </ol>
        </nav>
    </div>

    <section class="section">
        <div class="row">
            <!-- Thống kê đánh giá -->
            <div class="col-lg-3 col-md-6">
                <div class="card info-card">
                    <div class="card-body">
                        <h5 class="card-title">Điểm đánh giá</h5>
                        <div class="d-flex align-items-center">
                            <div class="card-icon rounded-circle d-flex align-items-center justify-content-center">
                                <i class="bi bi-star"></i>
                            </div>
                            <div class="ps-3">
                                <h6>4.2/5</h6>
                                <span class="text-success small pt-1 fw-bold">+0.3</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-3 col-md-6">
                <div class="card info-card sales-card">
                    <div class="card-body">
                        <h5 class="card-title">Tổng đánh giá</h5>
                        <div class="d-flex align-items-center">
                            <div class="card-icon rounded-circle d-flex align-items-center justify-content-center">
                                <i class="bi bi-chat-quote"></i>
                            </div>
                            <div class="ps-3">
                                <h6>1,248</h6>
                                <span class="text-success small pt-1 fw-bold">+12%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-3 col-md-6">
                <div class="card info-card revenue-card">
                    <div class="card-body">
                        <h5 class="card-title">Phản hồi đã trả lời</h5>
                        <div class="d-flex align-items-center">
                            <div class="card-icon rounded-circle d-flex align-items-center justify-content-center">
                                <i class="bi bi-check-circle"></i>
                            </div>
                            <div class="ps-3">
                                <h6>89%</h6>
                                <span class="text-success small pt-1 fw-bold">+5%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-3 col-md-6">
                <div class="card info-card customers-card">
                    <div class="card-body">
                        <h5 class="card-title">Đánh giá tiêu cực</h5>
                        <div class="d-flex align-items-center">
                            <div class="card-icon rounded-circle d-flex align-items-center justify-content-center">
                                <i class="bi bi-emoji-frown"></i>
                            </div>
                            <div class="ps-3">
                                <h6>4.2%</h6>
                                <span class="text-danger small pt-1 fw-bold">-1.2%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-12">
                <div class="card">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h5 class="card-title">Quản lý đánh giá & phản hồi</h5>
                            <div>
                                <button class="btn btn-outline-primary me-2">
                                    <i class="bi bi-download"></i> Xuất báo cáo
                                </button>
                                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#responseTemplateModal">
                                    <i class="bi bi-file-earmark-text"></i> Mẫu phản hồi
                                </button>
                            </div>
                        </div>

                        <!-- Bộ lọc -->
                        <div class="row mb-4">
                            <div class="col-md-3">
                                <select class="form-select" id="filter-star" onchange="filterFeedbacks()">
                                    <option selected>Tất cả đánh giá</option>
                                    <option>5 sao</option>
                                    <option>4 sao</option>
                                    <option>3 sao</option>
                                    <option>2 sao</option>
                                    <option>1 sao</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <select class="form-select" id="filter-status" onchange="filterFeedbacks()">
                                    <option selected>Tất cả trạng thái</option>
                                    <option>Chưa trả lời</option>
                                    <option>Đã trả lời</option>
                                    <option>Đã xử lý</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <select class="form-select" id="filter-source" onchange="filterFeedbacks()">
                                    <option selected>Tất cả nguồn</option>
                                    <option>Website</option>
                                    <option>Booking.com</option>
                                    <option>Agoda</option>
                                    <option>Trực tiếp</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <button class="btn btn-outline-primary w-100" onclick="filterFeedbacks()">Lọc</button>
                            </div>
                        </div>

                        <!-- Phân phối đánh giá -->
                        <div class="row mb-4">
                            <div class="col-lg-8">
                                <div class="card">
                                    <div class="card-header">
                                        <h6 class="card-title mb-0">Phân phối đánh giá</h6>
                                    </div>
                                    <div class="card-body">
                                        <!-- 5 sao -->
                                        <div class="row align-items-center mb-2">
                                            <div class="col-1">
                                                <span class="rating-stars">★★★★★</span>
                                            </div>
                                            <div class="col-8">
                                                <div class="progress">
                                                    <div class="progress-bar bg-success" style="width: 65%"></div>
                                                </div>
                                            </div>
                                            <div class="col-3">
                                                <span class="fw-bold">65% (811)</span>
                                            </div>
                                        </div>
                                        <!-- 4 sao -->
                                        <div class="row align-items-center mb-2">
                                            <div class="col-1">
                                                <span class="rating-stars">★★★★☆</span>
                                            </div>
                                            <div class="col-8">
                                                <div class="progress">
                                                    <div class="progress-bar bg-info" style="width: 22%"></div>
                                                </div>
                                            </div>
                                            <div class="col-3">
                                                <span class="fw-bold">22% (275)</span>
                                            </div>
                                        </div>
                                        <!-- 3 sao -->
                                        <div class="row align-items-center mb-2">
                                            <div class="col-1">
                                                <span class="rating-stars">★★★☆☆</span>
                                            </div>
                                            <div class="col-8">
                                                <div class="progress">
                                                    <div class="progress-bar bg-warning" style="width: 8%"></div>
                                                </div>
                                            </div>
                                            <div class="col-3">
                                                <span class="fw-bold">8% (100)</span>
                                            </div>
                                        </div>
                                        <!-- 2 sao -->
                                        <div class="row align-items-center mb-2">
                                            <div class="col-1">
                                                <span class="rating-stars">★★☆☆☆</span>
                                            </div>
                                            <div class="col-8">
                                                <div class="progress">
                                                    <div class="progress-bar bg-orange" style="width: 3%"></div>
                                                </div>
                                            </div>
                                            <div class="col-3">
                                                <span class="fw-bold">3% (37)</span>
                                            </div>
                                        </div>
                                        <!-- 1 sao -->
                                        <div class="row align-items-center mb-2">
                                            <div class="col-1">
                                                <span class="rating-stars">★☆☆☆☆</span>
                                            </div>
                                            <div class="col-8">
                                                <div class="progress">
                                                    <div class="progress-bar bg-danger" style="width: 2%"></div>
                                                </div>
                                            </div>
                                            <div class="col-3">
                                                <span class="fw-bold">2% (25)</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h6 class="card-title mb-0">Thống kê theo hạng mục</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="mb-3">
                                            <small class="text-muted">Dịch vụ phòng</small>
                                            <div class="fw-bold">4.5/5</div>
                                            <div class="progress" style="height: 6px;">
                                                <div class="progress-bar bg-success" style="width: 90%"></div>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <small class="text-muted">Vệ sinh</small>
                                            <div class="fw-bold">4.3/5</div>
                                            <div class="progress" style="height: 6px;">
                                                <div class="progress-bar bg-info" style="width: 86%"></div>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <small class="text-muted">Nhân viên</small>
                                            <div class="fw-bold">4.7/5</div>
                                            <div class="progress" style="height: 6px;">
                                                <div class="progress-bar bg-success" style="width: 94%"></div>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <small class="text-muted">Vị trí</small>
                                            <div class="fw-bold">4.8/5</div>
                                            <div class="progress" style="height: 6px;">
                                                <div class="progress-bar bg-success" style="width: 96%"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Danh sách đánh giá -->
                        <div class="row">
                            <!-- Đánh giá 1 - Positive -->
                            <div class="col-lg-6 mb-4">
                                <div class="card feedback-card positive">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-start mb-3">
                                            <div class="d-flex align-items-center">
                                                <div class="customer-avatar bg-success me-3">
                                                    NA
                                                </div>
                                                <div>
                                                    <h6 class="card-title mb-1">Nguyễn Văn A</h6>
                                                    <div class="rating-stars">
                                                        <i class="bi bi-star-fill"></i>
                                                        <i class="bi bi-star-fill"></i>
                                                        <i class="bi bi-star-fill"></i>
                                                        <i class="bi bi-star-fill"></i>
                                                        <i class="bi bi-star-fill"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <div>
                                                <span class="badge bg-success sentiment-badge">Tích cực</span>
                                                <small class="text-muted d-block">15/06/2024</small>
                                            </div>
                                        </div>

                                        <div class="feedback-content mb-3">
                                            <p class="mb-2">"Trải nghiệm tuyệt vời! Phòng sạch sẽ, nhân viên nhiệt tình và chuyên nghiệp. Đặc biệt là dịch vụ ăn uống rất ngon miệng."</p>
                                            <small class="text-muted">Phòng Deluxe 201 • 2 đêm</small>
                                        </div>

                                        <div class="response-box">
                                            <div class="d-flex justify-content-between align-items-center mb-2">
                                                <small class="fw-bold">Phản hồi từ khách sạn:</small>
                                                <small class="text-muted">16/06/2024</small>
                                            </div>
                                            <p class="mb-0">"Cảm ơn anh A đã dành những lời khen tuyệt vời cho chúng tôi! Rất mong được đón tiếp anh trong những lần sau."</p>
                                            <div class="mt-2">
                                                <span class="badge bg-success sentiment-badge">Đã trả lời</span>
                                            </div>
                                        </div>
                                        <div class="feedback-actions mt-3">
                                            <button class="btn btn-sm btn-outline-primary" title="Đánh giá hữu ích" onclick="markUseful(this)">
                                                <i class="bi bi-hand-thumbs-up"></i> Hữu ích
                                            </button>
                                            <button class="btn btn-sm btn-outline-warning" title="Sửa phản hồi"
                                                onclick="editReply('Nguyễn Văn A', 'Trải nghiệm tuyệt vời! Phòng sạch sẽ, nhân viên nhiệt tình và chuyên nghiệp. Đặc biệt là dịch vụ ăn uống rất ngon miệng.', 'Cảm ơn anh A đã dành những lời khen tuyệt vời cho chúng tôi! Rất mong được đón tiếp anh trong những lần sau.')">
                                                <i class="bi bi-pencil"></i> Sửa phản hồi
                                            </button>
                                            <button class="btn btn-sm btn-outline-success" title="Đánh dấu đã xử lý" onclick="markHandled(this)">
                                                <i class="bi bi-check-circle"></i> Đã xử lý
                                            </button>
                                            <button class="btn btn-sm btn-outline-danger" title="Xóa đánh giá" onclick="deleteFeedback(this)">
                                                <i class="bi bi-trash"></i> Xóa
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Đánh giá 2 - Negative -->
                            <div class="col-lg-6 mb-4">
                                <div class="card feedback-card negative">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-start mb-3">
                                            <div class="d-flex align-items-center">
                                                <div class="customer-avatar bg-danger me-3">
                                                    TB
                                                </div>
                                                <div>
                                                    <h6 class="card-title mb-1">Trần Thị B</h6>
                                                    <div class="rating-stars">
                                                        <i class="bi bi-star-fill"></i>
                                                        <i class="bi bi-star-fill"></i>
                                                        <i class="bi bi-star"></i>
                                                        <i class="bi bi-star"></i>
                                                        <i class="bi bi-star"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <div>
                                                <span class="badge bg-danger sentiment-badge">Tiêu cực</span>
                                                <small class="text-muted d-block">16/06/2024</small>
                                            </div>
                                        </div>

                                        <div class="feedback-content mb-3">
                                            <p class="mb-2">"Wifi rất chậm, điều hòa hoạt động không ổn định. Nhân viên phục vụ còn thiếu chuyên nghiệp. Hy vọng khách sạn cải thiện."</p>
                                            <small class="text-muted">Phòng Standard 102 • 1 đêm</small>
                                        </div>

                                        <div class="alert alert-warning">
                                            <small><i class="bi bi-exclamation-triangle"></i> <strong>Cần phản hồi ngay:</strong> Đánh giá tiêu cực chưa được trả lời</small>
                                        </div>

                                        <div class="feedback-actions mt-3">
                                            <button class="btn btn-sm btn-outline-primary" title="Phản hồi khách hàng"
                                                onclick="openReplyModal('Trần Thị B', 'Wifi rất chậm, điều hòa hoạt động không ổn định. Nhân viên phục vụ còn thiếu chuyên nghiệp. Hy vọng khách sạn cải thiện.')">
                                                <i class="bi bi-reply"></i> Phản hồi
                                            </button>
                                            <button class="btn btn-sm btn-outline-info" title="Liên hệ trực tiếp" onclick="contactCustomer(this)">
                                                <i class="bi bi-telephone"></i> Liên hệ
                                            </button>
                                            <button class="btn btn-sm btn-outline-secondary" title="Báo cáo đánh giá xấu" onclick="reportFeedback(this)">
                                                <i class="bi bi-flag"></i> Báo cáo
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Đánh giá 3 - Neutral -->
                            <div class="col-lg-6 mb-4">
                                <div class="card feedback-card neutral">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-start mb-3">
                                            <div class="d-flex align-items-center">
                                                <div class="customer-avatar bg-warning me-3">
                                                    LC
                                                </div>
                                                <div>
                                                    <h6 class="card-title mb-1">Lê Văn C</h6>
                                                    <div class="rating-stars">
                                                        <i class="bi bi-star-fill"></i>
                                                        <i class="bi bi-star-fill"></i>
                                                        <i class="bi bi-star-fill"></i>
                                                        <i class="bi bi-star-half"></i>
                                                        <i class="bi bi-star"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <div>
                                                <span class="badge bg-warning sentiment-badge">Trung bình</span>
                                                <small class="text-muted d-block">14/06/2024</small>
                                            </div>
                                        </div>

                                        <div class="feedback-content mb-3">
                                            <p class="mb-2">"Khách sạn ổn, vị trí thuận tiện. Tuy nhiên đồ ăn sáng hơi ít lựa chọn. Phòng tắm cần được vệ sinh kỹ hơn."</p>
                                            <small class="text-muted">Phòng Suite 305 • 3 đêm</small>
                                        </div>

                                        <div class="feedback-actions mt-3">
                                            <button class="btn btn-sm btn-outline-primary" title="Phản hồi khách hàng"
                                                onclick="openReplyModal('Lê Văn C', 'Khách sạn ổn, vị trí thuận tiện. Tuy nhiên đồ ăn sáng hơi ít lựa chọn. Phòng tắm cần được vệ sinh kỹ hơn.')">
                                                <i class="bi bi-reply"></i> Phản hồi
                                            </button>
                                            <button class="btn btn-sm btn-outline-success" title="Đánh dấu đã xử lý" onclick="markNeutralHandled(this)">
                                                <i class="bi bi-check-circle"></i> Đánh dấu
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Phân trang -->
                        <nav aria-label="Page navigation">
                            <ul class="pagination justify-content-center">
                                <li class="page-item disabled">
                                    <a class="page-link" href="#" tabindex="-1">Trước</a>
                                </li>
                                <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                <li class="page-item"><a class="page-link" href="#">2</a></li>
                                <li class="page-item"><a class="page-link" href="#">3</a></li>
                                <li class="page-item">
                                    <a class="page-link" href="#">Tiếp</a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>

<!-- Modal Phản hồi -->
<div class="modal fade" id="replyModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Phản hồi đánh giá</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div id="replySuccess" class="modal-success"><i class="bi bi-check-circle"></i> Gửi phản hồi thành công!</div>
                <div class="mb-3">
                    <label class="form-label">Khách hàng</label>
                    <input type="text" class="form-control" value="Trần Thị B" readonly>
                </div>
                <div class="mb-3">
                    <label class="form-label">Đánh giá gốc</label>
                    <textarea class="form-control" rows="3" readonly>"Wifi rất chậm, điều hòa hoạt động không ổn định. Nhân viên phục vụ còn thiếu chuyên nghiệp. Hy vọng khách sạn cải thiện."</textarea>
                </div>
                <div class="mb-3">
                    <label class="form-label">Phản hồi của bạn *</label>
                    <textarea class="form-control" rows="4" placeholder="Nhập phản hồi cho khách hàng..."></textarea>
                </div>
                <div class="mb-3">
                    <label class="form-label">Mẫu phản hồi nhanh</label>
                    <select class="form-select" onchange="insertTemplate(this.value)">
                        <option value="">Chọn mẫu phản hồi</option>
                        <option value="Cảm ơn bạn đã phản hồi. Chúng tôi sẽ khắc phục ngay.">Phản hồi vấn đề</option>
                        <option value="Cảm ơn bạn đã dành lời khen. Hy vọng được đón tiếp bạn lần sau.">Phản hồi tích cực</option>
                        <option value="Chúng tôi xin lỗi vì sự bất tiện này. Sẽ cải thiện ngay.">Xin lỗi khách hàng</option>
                    </select>
                </div>
                <div class="form-check mb-3">
                    <input class="form-check-input" type="checkbox" checked>
                    <label class="form-check-label">
                        Gửi email thông báo cho khách hàng
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <span id="replySpinner" class="loading-spinner spinner-border spinner-border-sm text-primary"></span>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button>
                <button type="button" class="btn btn-primary" onclick="sendReply(this)">Gửi phản hồi</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Mẫu phản hồi -->
<div class="modal fade" id="responseTemplateModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Quản lý mẫu phản hồi</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <!-- Danh sách mẫu phản hồi sẽ được JS cập nhật động -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
            </div>
        </div>
    </div>
</div>

<!-- Vendor JS Files -->
<script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="assets/vendor/php-email-form/validate.js"></script>

<!-- Template Main JS File -->
<script src="assets/js/main.js"></script>
<script src="assets/js/auth.js"></script>

</body>
</html>
